#
# Dynamically generated by Chef on <%= node.workorder.rfcCi.ciName %> in namespace <%= node.workorder.rfcCi.nsPath %>
#
# Local modifications will be overwritten by Chef.
#

# Run Tomcat as this user ID. Not setting this or leaving it blank will use the
# default of tomcat6.
<% 
if node["tomcat"].has_key?("tomcat_user") && !node["tomcat"]["tomcat_user"].empty?
%>
TOMCAT6_USER=<%= node["tomcat"]["tomcat_user"] %>
<% 
else
%>
TOMCAT6_USER=<%= node["tomcat"]["user"] %>
<%
end
%>

# Run Tomcat as this group ID. Not setting this or leaving it blank will use
# the default of tomcat6.
<% 
if node["tomcat"].has_key?("tomcat_group")  && !node["tomcat"]["tomcat_group"].empty?
%>
TOMCAT6_GROUP=<%= node["tomcat"]["tomcat_group"] %>
<% 
else
%>
TOMCAT6_GROUP=<%= node["tomcat"]["group"] %>
<%
end
%>

# The home directory of the Java development kit (JDK). You need at least
# JDK version 1.5. If JAVA_HOME is not set, some common directories for 
# OpenJDK, the Sun JDK, and various J2SE 1.5 versions are tried.
JAVA_HOME=<%= node["java"]["java_home"] %>

# Directory where the Tomcat 6 binary distribution resides.  This a read-only
# directory that can be shared by all Tomcat instances running on the machine.
# Default: /usr/share/tomcat6
CATALINA_HOME=<%= node["tomcat"]["home"] %>

# Directory for per-instance configuration files and webapps. It contains the
# directories conf, logs, webapps, work and temp. See RUNNING.txt for details.
# Default: /var/lib/tomcat6
CATALINA_BASE=<%= node["tomcat"]["base"] %>

# You may pass JVM startup parameters to Java here. If unset, the default
# options (-Djava.awt.headless=true -Xmx128m) will be used.
JAVA_OPTS="<%= node["tomcat"]["java_options"] %>"

<% if node["tomcat"]["system_properties"] != nil &&
   JSON.parse(node["tomcat"]["system_properties"]).keys.size > 0
%>
<% system_props = JSON.parse(node["tomcat"]["system_properties"]).map{ |k,v| "-D#{k}=#{v} " }.join(" ") %>
JAVA_OPTS="${JAVA_OPTS} <%= system_props %>" 
<% end %>  


JAVA_OPTS="${JAVA_OPTS} -Xmx<%= node["tomcat"]["mem_max"] %>"
JAVA_OPTS="${JAVA_OPTS} -Xms<%= node["tomcat"]["mem_start"] %>"
<% opts = JSON.parse(node["tomcat"]["startup_params"]).map{ |v| "-XX:#{v} " } %>
JAVA_OPTS="${JAVA_OPTS} <%= opts.join(" ") %>"


# Java compiler to use for translating JavaServer Pages (JSPs). You can use all
# compilers that are accepted by Ant's build.compiler property.
#JSP_COMPILER=javac

# Use the Java security manager? (yes/no, default: no)
TOMCAT6_SECURITY=<%= node["tomcat"]["use_security_manager"] == 'true' ? "yes" : "no" %>

# Number of days to keep logfiles in /var/log/tomcat6. Default is 14 days.
#LOGFILE_DAYS=14

# Location of the JVM temporary directory
# WARNING: This directory will be destroyed and recreated at every startup !
JVM_TMP=<%= node["tomcat"]["tmp_dir"] %>

# If you run Tomcat on port numbers that are all higher than 1023, then you
# do not need authbind.  It is used for binding Tomcat to lower port numbers.
# NOTE: authbind works only with IPv4.  Do not enable it when using IPv6.
# (yes/no, default: no)
#AUTHBIND=no

# Override with tomcat env
<%
if node["tomcat"].has_key?("environment")
	envMap = JSON.parse(node["tomcat"]["environment"])
	envMap.each_key do |key|
%>
<%= key %>=<%= envMap[key] %>
<%
	end
end
%>
